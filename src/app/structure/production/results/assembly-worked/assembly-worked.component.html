<div class="panel panel-default">

    <div class="panel-heading">
      <div class="text-center">
        <span class="h4 block m-b-sm">{{ panelTitle }}</span>
      </div>
      <div class="text-right">
      </div>
    </div>

    <div class="panel-body">
      <ngx-datatable
        [style.height.px]=gridHeight
        class="bootstrap"
        [rows]="rows"
        [columnMode]="'force'"
        [headerHeight]="30"
        [rowHeight]="30"
        [selected]="selected"
        [scrollbarV]="true"
        [scrollbarH]="false"
        [messages]="messages">
        <ngx-datatable-column prop="order_no" name="수주번호" [width]="150" [canAutoResize]="false"
                              [resizeable]="false" cellClass="text-center"></ngx-datatable-column>
        <ngx-datatable-column prop="partner_name" name="거래처"></ngx-datatable-column>
        <ngx-datatable-column prop="product_name" name="제품명"></ngx-datatable-column>
        <ngx-datatable-column prop="product_type" name="구분"></ngx-datatable-column>
        <ngx-datatable-column prop="qty" name="수주수량" [width]="100" [canAutoResize]="false"
                              [resizeable]="false" cellClass="text-right">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span>{{ value | numberFormat }}</span>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column prop="production_qty" name="생산수량" [width]="100" [canAutoResize]="false"
                              [resizeable]="false" cellClass="text-right">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span>{{ value | numberFormat }}</span>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column prop="remind_qty" name="잔여수량" [width]="100" [canAutoResize]="false"
                              [resizeable]="false" cellClass="text-right">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span>{{ value | numberFormat }}</span>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column prop="line_no" name="작업라인" cellClass="text-center"
                              [sortable]="false"></ngx-datatable-column>
        <ngx-datatable-column prop="id" name="입력" [width]="65" [canAutoResize]="false" [resizeable]="false" [sortable]="false"
                              cellClass="text-center">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <div>
              <button (click)="openModal('row',value)" class="btn btn-xs btn-primary">
                입력
              </button>
            </div>
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>
    <div class="panel-footer text-center">
      <!-- <button type="button" (click)="Save()" [disabled]="!inputForm.valid" class="btn btn-primary btn-save">완료</button>
      <button type="button" (click)="Reset()" class="btn btn-primary btn-cancel">취소</button> -->
    </div>
  </div>

  <div bsModal #InputFormModal="bs-modal" id="input-form" class="modal fade" tabindex="-1" role="dialog"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" style="width: 1000px !important;">
      <form [formGroup]="inputForm">
        <div class="modal-header">
          <button type="button" class="close" (click)="InputFormModal.hide()"><span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">{{ inputFormTitle }}</h4>
        </div>
        <div class="modal-body" style="overflow-y: scroll; height: 700px;">
        <div class="col-lg-5">
          <input type="hidden" formControlName="id" id="id"/>
            <div class="form-group">
              <div class="row">
                <label for="production_date" class="col-lg-4 control-label">
                  작업일자
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="production_date" id="production_date" bsDatepicker placement="bottom left" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>
        
            <div class="form-group">
              <div class="row">
                <label for="order_no" class="col-lg-4 control-label">
                  수주번호
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="order_no" id="order_no" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <label for="partner_name" class="col-lg-4 control-label">
                    거래처
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="partner_name" id="partner_name" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <label for="line_no" class="col-lg-4 control-label">
                    작업라인
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="line_no" id="line_no" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>
           
            <div class="form-group">
              <div class="row">
                <label for="product_name" class="col-lg-4 control-label">
                    제품명
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="product_name" id="product_name" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <label for="product_type" class="col-lg-4 control-label">
                    규격
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="product_type" id="product_type" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>
 
            <div class="form-group">
              <div class="row">
                <label for="qty" class="col-lg-4 control-label">
                    수주수량
                </label>
                <div class="col-lg-8">
                  <input readonly type="text" formControlName="qty" id="qty" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <label for="add_production_qty" class="col-lg-4 control-label">
                    생산수량 <span class="text-xs text-danger glyphicon glyphicon-asterisk"></span>
                </label>
                <div class="col-lg-8">
                  <input type="text" formControlName="add_production_qty" id="add_production_qty" (keyup)="writeQty($event)" class="form-control input-sm w-sm"/>
                </div>
              </div>
            </div>

            <div class="form-group">
              <table>
                <tr>
                  <th width="100px">
                    조립인력 <span class="text-xs text-danger glyphicon glyphicon-asterisk"></span>
                  </th>
                  <th width="100px">
                    작업시간 <span class="text-xs text-danger glyphicon glyphicon-asterisk"></span>
                  </th>
                </tr>
                <tr *ngFor='let production_personnel of [].constructor(personnelDataCnt); let index = index;'>
                  <div *ngIf="inputForm.value['personnel_id_'+(index+1)] != -1" style="display: contents"
                  id="personnel_wrap_{{index+1}}">
                  <td>
                    <input type="text" formControlName="personnel_{{index+1}}"
                                      id="personnel_{{index+1}}"
                                      [typeahead]="personnel"
                                      typeaheadOptionField="name"
                                      [typeaheadOptionsLimit]="50"
                                      [typeaheadScrollable]="true"
                                      [typeaheadMinLength]="0"
                                      (typeaheadOnSelect)="onSelectPersonnel($event, index+1)"
                                      class="input-sm form-control w-xs" />
                    <input type="hidden" formControlName="personnel_id_{{index+1}}" id="personnel_id_{{index+1}}">
                  </td>
                  <td>
                    <input type="text" formControlName="work_time_{{index+1}}" id="work_time_{{index+1}}" class="form-control input-sm w-xs"/>
                  </td>
                  <td>
                  <div style="display: flex;">
                    <button *ngIf="chkViewAddBtn(index+1)" (click)="addPersonnelRow()"
                            [disabled]="!inputForm.valid"
                            id="material_add_btn_{{index+1}}"
                            class="btn btn-sm btn-info btn-addon" style="margin-right: 5px">추가
                    </button>
                    <button *ngIf="chkViewRemoveBtn(index+1)"
                            (click)="removePersonnelRow(index+1)"
                            id="material_remove_btn_{{index+1}}"
                            class="btn btn-sm btn-danger btn-addon">삭제
                    </button>
                  </div>
                  </td>
                  </div>
                </tr>
              </table>
            </div>
          </div>
          <div class="col-lg-7">
              <div class="form-group">
                <div *ngFor='let material of [].constructor(materialDataCnt); let index = index;' class="row">
                  <div *ngIf="inputForm.value['material_name_'+(index+1)] != -1" style="display: contents"
                  id="material_wrap_{{index+1}}">
                  <label for="material_name" class="col-lg-3 control-label">
                    소요자재 {{index+1}}
                  </label>
                  <div class="col-lg-4">
                    <input type="text" readonly formControlName="material_name_{{index+1}}" id="material_name_{{index+1}}" class="input-sm form-control w-sm inline v-middle" />
                  </div>
                  <label for="material_qty" class="col-lg-2 control-label">
                    수량 
                  </label>
                  <div class="col-lg-3">
                    <input type="text" readonly formControlName="material_qty_{{index+1}}" id="material_qty_{{index+1}}" class="form-control input-sm w-xs"/>
                    <input type="hidden" formControlName="hidden_material_qty_{{index+1}}" id="hidden_material_qty_{{index+1}}" class="form-control input-sm w-xs"/>
                  </div>
                  </div>
                </div>
              </div>
          </div>
        </div>

        <div class="modal-footer">
          <div class="text-center">
            <button type="button" (click)="Save()" [disabled]="!inputForm.valid" class="btn btn-primary btn-save">완료
            </button>
            <button type="button" (click)="InputFormModal.hide()" class="btn btn-primary btn-cancel">취소</button>
          </div>
        </div>
      </form>

    </div>
  </div>
</div>

  <div *ngIf="isLoadingProgress" class="loading-progress">

    <div class="sk-fading-circle">
      <div class="sk-circle1 sk-circle"></div>
      <div class="sk-circle2 sk-circle"></div>
      <div class="sk-circle3 sk-circle"></div>
      <div class="sk-circle4 sk-circle"></div>
      <div class="sk-circle5 sk-circle"></div>
      <div class="sk-circle6 sk-circle"></div>
      <div class="sk-circle7 sk-circle"></div>
      <div class="sk-circle8 sk-circle"></div>
      <div class="sk-circle9 sk-circle"></div>
      <div class="sk-circle10 sk-circle"></div>
      <div class="sk-circle11 sk-circle"></div>
      <div class="sk-circle12 sk-circle"></div>
    </div>

  </div>
